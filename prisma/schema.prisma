generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-arm64-openssl-3.0.x", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("LLES_DATABASE_URL")
}

model Card {
  id            Int             @id @default(autoincrement())
  rarity        String?         @db.VarChar(50)
  limited       String?         @db.VarChar(50)
  cardName      String          @map("card_name") @db.VarChar(255)
  cardUrl       String?         @map("card_url")
  characterName String          @map("character_name") @db.VarChar(255)
  styleType     String?         @map("style_type") @db.VarChar(100)
  releaseDate   DateTime?       @map("release_date") @db.Date
  createdAt     DateTime?       @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt     DateTime?       @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  isLocked      Boolean?        @default(false) @map("is_locked")
  accessories   CardAccessory[]
  detail        CardDetail?

  @@unique([cardName, characterName])
  @@index([cardName], map: "idx_cards_card_name")
  @@index([characterName], map: "idx_cards_character_name")
  @@index([rarity], map: "idx_cards_rarity")
  @@index([isLocked], map: "idx_cards_is_locked")
  @@map("cards")
}

model CardDetail {
  id                    Int       @id @default(autoincrement())
  cardId                Int       @unique @map("card_id")
  favoriteMode          String?   @map("favorite_mode") @db.VarChar(100)
  acquisitionMethod     String?   @map("acquisition_method")
  awakeBeforeUrl        String?   @map("awake_before_url")
  awakeAfterUrl         String?   @map("awake_after_url")
  awakeBeforeStorageUrl String?   @map("awake_before_storage_url")
  awakeAfterStorageUrl  String?   @map("awake_after_storage_url")
  smileMaxLevel         String?   @map("smile_max_level") @db.VarChar(50)
  pureMaxLevel          String?   @map("pure_max_level") @db.VarChar(50)
  coolMaxLevel          String?   @map("cool_max_level") @db.VarChar(50)
  mentalMaxLevel        String?   @map("mental_max_level") @db.VarChar(50)
  specialAppealName     String?   @map("special_appeal_name") @db.VarChar(255)
  specialAppealAp       String?   @map("special_appeal_ap") @db.VarChar(50)
  specialAppealEffect   String?   @map("special_appeal_effect")
  skillName             String?   @map("skill_name") @db.VarChar(255)
  skillAp               String?   @map("skill_ap") @db.VarChar(50)
  skillEffect           String?   @map("skill_effect")
  traitName             String?   @map("trait_name") @db.VarChar(255)
  traitEffect           String?   @map("trait_effect")
  createdAt             DateTime? @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt             DateTime? @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  isLocked              Boolean?  @default(false) @map("is_locked")
  card                  Card      @relation(fields: [cardId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([cardId], map: "idx_card_details_card_id")
  @@index([isLocked], map: "idx_card_details_is_locked")
  @@map("card_details")
}

model CardAccessory {
  id           Int       @id @default(autoincrement())
  cardId       Int       @map("card_id")
  parentType   String    @map("parent_type") @db.VarChar(50)
  name         String    @db.VarChar(255)
  ap           String?   @db.VarChar(50)
  effect       String?
  traitName    String?   @map("trait_name") @db.VarChar(255)
  traitEffect  String?   @map("trait_effect")
  displayOrder Int?      @default(0) @map("display_order")
  createdAt    DateTime? @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt    DateTime? @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  isLocked     Boolean?  @default(false) @map("is_locked")
  card         Card      @relation(fields: [cardId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([cardId], map: "idx_card_accessories_card_id")
  @@index([parentType], map: "idx_card_accessories_parent_type")
  @@index([isLocked], map: "idx_card_accessories_is_locked")
  @@map("card_accessories")
}

model Song {
  id                    Int                    @id @default(autoincrement())
  songName              String                 @map("song_name") @db.VarChar(255)
  songUrl               String?                @map("song_url")
  category              String                 @db.VarChar(100)
  attribute             String                 @db.VarChar(100)
  centerCharacter       String                 @map("center_character") @db.VarChar(255)
  singers               String                 @db.VarChar(500)
  participations        String?                @db.Text
  liveAnalyzerImageUrl  String?                @map("live_analyzer_image_url")
  jacketImageUrl        String?                @map("jacket_image_url")
  isLocked              Boolean?               @default(false) @map("is_locked")
  createdAt             DateTime?              @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt             DateTime?              @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  moodProgressions      SongMoodProgression[]
  liveGrandPrixDetails  LiveGrandPrixDetail[]
  gradeChallengeDetails GradeChallengeDetail[]

  @@index([songName], map: "idx_songs_song_name")
  @@index([category], map: "idx_songs_category")
  @@index([attribute], map: "idx_songs_attribute")
  @@index([centerCharacter], map: "idx_songs_center_character")
  @@index([isLocked], map: "idx_songs_is_locked")
  @@map("songs")
}

model SongMoodProgression {
  id           Int       @id @default(autoincrement())
  songId       Int       @map("song_id")
  section      String    @db.VarChar(100)
  progression  String
  sectionOrder Int       @map("section_order")
  isLocked     Boolean?  @default(false) @map("is_locked")
  createdAt    DateTime? @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt    DateTime? @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  song         Song      @relation(fields: [songId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([songId], map: "idx_song_mood_progressions_song_id")
  @@index([isLocked], map: "idx_song_mood_progressions_is_locked")
  @@map("song_mood_progressions")
}

model LiveGrandPrix {
  id        Int                   @id @default(autoincrement())
  startDate DateTime              @map("start_date") @db.Timestamp(6)
  endDate   DateTime              @map("end_date") @db.Timestamp(6)
  eventName String                @map("event_name") @db.VarChar(255)
  eventUrl  String?               @map("event_url")
  yearTerm  String                @map("year_term") @db.VarChar(100)
  isLocked  Boolean?              @default(false) @map("is_locked")
  createdAt DateTime?             @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt DateTime?             @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  details   LiveGrandPrixDetail[]

  @@index([eventName], map: "idx_live_grand_prix_event_name")
  @@index([yearTerm], map: "idx_live_grand_prix_year_term")
  @@index([startDate], map: "idx_live_grand_prix_start_date")
  @@index([isLocked], map: "idx_live_grand_prix_is_locked")
  @@map("live_grand_prix")
}

model LiveGrandPrixDetail {
  id              Int                          @id @default(autoincrement())
  liveGrandPrixId Int                          @map("live_grand_prix_id")
  stageName       String                       @map("stage_name") @db.VarChar(100)
  specialEffect   String?                      @map("special_effect")
  songId          Int?                         @map("song_id")
  isLocked        Boolean?                     @default(false) @map("is_locked")
  createdAt       DateTime?                    @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt       DateTime?                    @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  liveGrandPrix   LiveGrandPrix                @relation(fields: [liveGrandPrixId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  song            Song?                        @relation(fields: [songId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  sectionEffects  LiveGrandPrixSectionEffect[]

  @@index([liveGrandPrixId], map: "idx_live_grand_prix_details_live_grand_prix_id")
  @@index([songId], map: "idx_live_grand_prix_details_song_id")
  @@index([isLocked], map: "idx_live_grand_prix_details_is_locked")
  @@map("live_grand_prix_details")
}

model LiveGrandPrixSectionEffect {
  id           Int                 @id @default(autoincrement())
  detailId     Int                 @map("detail_id")
  sectionName  String              @map("section_name") @db.VarChar(100)
  effect       String
  sectionOrder Int                 @map("section_order")
  isLocked     Boolean?            @default(false) @map("is_locked")
  createdAt    DateTime?           @default(now()) @map("created_at") @db.Timestamp(6)
  detail       LiveGrandPrixDetail @relation(fields: [detailId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([detailId], map: "idx_live_grand_prix_section_effects_detail_id")
  @@index([isLocked], map: "idx_live_grand_prix_section_effects_is_locked")
  @@map("live_grand_prix_section_effects")
}

model GradeChallenge {
  id        Int                    @id @default(autoincrement())
  title     String                 @db.VarChar(255)
  startDate DateTime?              @map("start_date") @db.Timestamp(6)
  endDate   DateTime?              @map("end_date") @db.Timestamp(6)
  detailUrl String?                @map("detail_url")
  termName  String?                @map("term_name") @db.VarChar(100)
  isLocked  Boolean?               @default(false) @map("is_locked")
  createdAt DateTime?              @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt DateTime?              @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  details   GradeChallengeDetail[]

  @@unique([title])
  @@index([title], map: "idx_grade_challenges_title")
  @@index([termName], map: "idx_grade_challenges_term_name")
  @@index([startDate], map: "idx_grade_challenges_start_date")
  @@index([isLocked], map: "idx_grade_challenges_is_locked")
  @@map("grade_challenges")
}

model GradeChallengeDetail {
  id               Int                           @id @default(autoincrement())
  gradeChallengeId Int                           @map("grade_challenge_id")
  stageName        String                        @map("stage_name") @db.VarChar(100)
  specialEffect    String?                       @map("special_effect")
  songId           Int?                          @map("song_id")
  isLocked         Boolean?                      @default(false) @map("is_locked")
  createdAt        DateTime?                     @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt        DateTime?                     @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  gradeChallenge   GradeChallenge                @relation(fields: [gradeChallengeId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  song             Song?                         @relation(fields: [songId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  sectionEffects   GradeChallengeSectionEffect[]

  @@unique([gradeChallengeId, stageName])
  @@index([gradeChallengeId], map: "idx_grade_challenge_details_grade_challenge_id")
  @@index([songId], map: "idx_grade_challenge_details_song_id")
  @@index([isLocked], map: "idx_grade_challenge_details_is_locked")
  @@map("grade_challenge_details")
}

model GradeChallengeSectionEffect {
  id           Int                  @id @default(autoincrement())
  detailId     Int                  @map("detail_id")
  sectionName  String               @map("section_name") @db.VarChar(100)
  effect       String
  sectionOrder Int                  @map("section_order")
  isLocked     Boolean?             @default(false) @map("is_locked")
  createdAt    DateTime?            @default(now()) @map("created_at") @db.Timestamp(6)
  detail       GradeChallengeDetail @relation(fields: [detailId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([detailId, sectionName])
  @@index([detailId], map: "idx_grade_challenge_section_effects_detail_id")
  @@index([isLocked], map: "idx_grade_challenge_section_effects_is_locked")
  @@map("grade_challenge_section_effects")
}
