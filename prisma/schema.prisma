generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-arm64-openssl-3.0.x", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("LLES_DATABASE_URL")
}

model Card {
  id            Int             @id @default(autoincrement())
  rarity        String?         @db.VarChar(50)
  limited       String?         @db.VarChar(50)
  cardName      String          @map("card_name") @db.VarChar(255)
  cardUrl       String?         @map("card_url")
  characterName String          @map("character_name") @db.VarChar(255)
  styleType     String?         @map("style_type") @db.VarChar(100)
  releaseDate   DateTime?       @map("release_date") @db.Date
  createdAt     DateTime?       @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt     DateTime?       @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  isLocked      Boolean?        @default(false) @map("is_locked")
  accessories   CardAccessory[]
  detail        CardDetail?

  @@unique([cardName, characterName])
  @@index([cardName], map: "idx_cards_card_name")
  @@index([characterName], map: "idx_cards_character_name")
  @@index([rarity], map: "idx_cards_rarity")
  @@index([isLocked], map: "idx_cards_is_locked")
  @@map("cards")
}

model CardDetail {
  id                    Int       @id @default(autoincrement())
  cardId                Int       @unique @map("card_id")
  favoriteMode          String?   @map("favorite_mode") @db.VarChar(100)
  acquisitionMethod     String?   @map("acquisition_method")
  awakeBeforeUrl        String?   @map("awake_before_url")
  awakeAfterUrl         String?   @map("awake_after_url")
  awakeBeforeStorageUrl String?   @map("awake_before_storage_url")
  awakeAfterStorageUrl  String?   @map("awake_after_storage_url")
  smileMaxLevel         String?   @map("smile_max_level") @db.VarChar(50)
  pureMaxLevel          String?   @map("pure_max_level") @db.VarChar(50)
  coolMaxLevel          String?   @map("cool_max_level") @db.VarChar(50)
  mentalMaxLevel        String?   @map("mental_max_level") @db.VarChar(50)
  specialAppealName     String?   @map("special_appeal_name") @db.VarChar(255)
  specialAppealAp       String?   @map("special_appeal_ap") @db.VarChar(50)
  specialAppealEffect   String?   @map("special_appeal_effect")
  skillName             String?   @map("skill_name") @db.VarChar(255)
  skillAp               String?   @map("skill_ap") @db.VarChar(50)
  skillEffect           String?   @map("skill_effect")
  traitName             String?   @map("trait_name") @db.VarChar(255)
  traitEffect           String?   @map("trait_effect")
  createdAt             DateTime? @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt             DateTime? @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  isLocked              Boolean?  @default(false) @map("is_locked")
  card                  Card      @relation(fields: [cardId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([cardId], map: "idx_card_details_card_id")
  @@index([isLocked], map: "idx_card_details_is_locked")
  @@map("card_details")
}

model CardAccessory {
  id           Int       @id @default(autoincrement())
  cardId       Int       @map("card_id")
  parentType   String    @map("parent_type") @db.VarChar(50)
  name         String    @db.VarChar(255)
  ap           String?   @db.VarChar(50)
  effect       String?
  traitName    String?   @map("trait_name") @db.VarChar(255)
  traitEffect  String?   @map("trait_effect")
  displayOrder Int?      @default(0) @map("display_order")
  createdAt    DateTime? @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt    DateTime? @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  isLocked     Boolean?  @default(false) @map("is_locked")
  card         Card      @relation(fields: [cardId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([cardId], map: "idx_card_accessories_card_id")
  @@index([parentType], map: "idx_card_accessories_parent_type")
  @@index([isLocked], map: "idx_card_accessories_is_locked")
  @@map("card_accessories")
}

model Song {
  id                   Int                    @id @default(autoincrement())
  songName             String                 @map("song_name") @db.VarChar(255)
  songUrl              String?                @map("song_url")
  category             String                 @db.VarChar(100)
  attribute            String                 @db.VarChar(100)
  centerCharacter      String                 @map("center_character") @db.VarChar(255)
  singers              String                 @db.VarChar(500)
  participations       String?                @db.Text
  liveAnalyzerImageUrl String?                @map("live_analyzer_image_url")
  jacketImageUrl       String?                @map("jacket_image_url")
  isLocked             Boolean?               @default(false) @map("is_locked")
  createdAt            DateTime?              @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt            DateTime?              @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  moodProgressions     SongMoodProgression[]

  @@index([songName], map: "idx_songs_song_name")
  @@index([category], map: "idx_songs_category")
  @@index([attribute], map: "idx_songs_attribute")
  @@index([centerCharacter], map: "idx_songs_center_character")
  @@index([isLocked], map: "idx_songs_is_locked")
  @@map("songs")
}

model SongMoodProgression {
  id           Int       @id @default(autoincrement())
  songId       Int       @map("song_id")
  section      String    @db.VarChar(100)
  progression  String
  sectionOrder Int       @map("section_order")
  isLocked     Boolean?  @default(false) @map("is_locked")
  createdAt    DateTime? @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt    DateTime? @default(now()) @updatedAt @map("updated_at") @db.Timestamp(6)
  song         Song      @relation(fields: [songId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([songId], map: "idx_song_mood_progressions_song_id")
  @@index([isLocked], map: "idx_song_mood_progressions_is_locked")
  @@map("song_mood_progressions")
}
