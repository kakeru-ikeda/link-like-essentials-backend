# ã‚­ãƒ£ãƒƒã‚·ãƒ¥è©•ä¾¡ã¾ã¨ã‚

## ğŸ¯ è©•ä¾¡çµæœï¼ˆ2025å¹´11æœˆ24æ—¥å®Ÿæ–½ï¼‰

### å®Ÿæ¸¬å€¤

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š BENCHMARK RESULTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Test                               Requests  Avg(ms)   Min(ms)   Max(ms)   
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Cold Start (First Request)      1         1607.64   1607.64   1607.64   
2. Cache Hit (Same Query)          50        2.96      1.86      16.76     
3. Different Card (Cold)           1         190.06    190.06    190.06    
4. List Query (Cold)               1         978.14    978.14    978.14    
5. List Query (Cached)             30        4.90      2.37      10.79     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ Cache Improvement: 99.82% faster
   Cold Start Avg: 1607.64ms â†’ Cached Avg: 2.96ms

Cache Hit Rate: 93.75%
```

## âœ… è©•ä¾¡

### 1. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡: **93.75%** â†’ âœ… å„ªç§€

- ç›®æ¨™: 80%ä»¥ä¸Š
- å®Ÿæ¸¬: **93.75%**
- è©•ä¾¡: **å„ªç§€** - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒéå¸¸ã«åŠ¹ã„ã¦ã„ã‚‹

### 2. ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ æ”¹å–„ç‡: **99.82%** â†’ âœ… ç†æƒ³çš„

- ç›®æ¨™: 80%ä»¥ä¸Šã®é«˜é€ŸåŒ–
- å®Ÿæ¸¬: **99.82%ã®é«˜é€ŸåŒ–ï¼ˆç´„543å€ï¼‰**
- è©•ä¾¡: **ç†æƒ³çš„** - 10å€ä»¥ä¸Šã®é«˜é€ŸåŒ–ã‚’é”æˆ

### 3. å¹³å‡ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ  â†’ âœ… ç›®æ¨™é”æˆ

| æ“ä½œ | ç›®æ¨™ | å®Ÿæ¸¬ | åˆ¤å®š |
|------|------|------|------|
| å˜ä¸€ã‚«ãƒ¼ãƒ‰å–å¾— (findById) | <5ms | 2.96ms | âœ… |
| ãƒªã‚¹ãƒˆæ¤œç´¢ (findAll) | <10ms | 4.90ms | âœ… |

## ğŸ‰ çµè«–

**Prisma + Redisã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯éå¸¸ã«åŠ¹æœçš„ã«æ©Ÿèƒ½ã—ã¦ã„ã¾ã™ï¼**

- âœ… ã™ã¹ã¦ã®è©•ä¾¡æŒ‡æ¨™ã§ç›®æ¨™ã‚’å¤§ããä¸Šå›ã‚‹
- âœ… åˆå›ã‚¢ã‚¯ã‚»ã‚¹å¾Œã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ãŒç´„500å€é«˜é€ŸåŒ–
- âœ… ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡93.75%ã§å®‰å®šé‹ç”¨å¯èƒ½
- âœ… ãƒŸãƒªç§’å˜ä½ã§ã®é«˜é€Ÿãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å®Ÿç¾

## ğŸ’¡ ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹æœã®ç¢ºèªæ–¹æ³•

### ç°¡å˜ãªç¢ºèªï¼ˆGraphQLã‚¯ã‚¨ãƒªï¼‰

```bash
# ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:4001/graphql ã«ã‚¢ã‚¯ã‚»ã‚¹

# ä»¥ä¸‹ã®ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œ
query {
  metricsSummary
}
```

### è©³ç´°ãªè¨ˆæ¸¬ï¼ˆãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ï¼‰

```bash
# ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼ˆåˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼‰
npm run dev

# ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯å®Ÿè¡Œ
npm run benchmark:cache
```

## ğŸ“Š ç¶™ç¶šçš„ãªç›£è¦–

æœ¬ç•ªç’°å¢ƒã§ã¯ä»¥ä¸‹ã‚’æ¨å¥¨ï¼š

1. **å®šæœŸçš„ãªãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯å®Ÿè¡Œ**
   ```bash
   npm run benchmark:cache > logs/cache-$(date +%Y%m%d).log
   ```

2. **ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ç›£è¦–**
   - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ãŒ80%ã‚’ä¸‹å›ã£ãŸã‚‰è¦èª¿æŸ»
   - ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ãŒ10msã‚’è¶…ãˆãŸã‚‰è¦æœ€é©åŒ–

3. **Redisç›£è¦–**
   ```bash
   # Redisæ¥ç¶šç¢ºèª
   docker compose -f docker/docker-compose.yml ps redis
   
   # Redisãƒ¡ãƒ¢ãƒªä½¿ç”¨çŠ¶æ³
   docker compose -f docker/docker-compose.yml exec redis redis-cli info memory
   ```

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

ã‚‚ã—ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ãŒä½ä¸‹ã—ãŸã‚‰ï¼š

1. TTLè¨­å®šã‚’ç¢ºèª: `src/infrastructure/cache/strategies/CardCacheStrategy.ts`
2. Redisæ¥ç¶šã‚’ç¢ºèª: `docker compose ps`
3. ãƒ¡ãƒ¢ãƒªä¸è¶³ã‚’ç¢ºèª: Redisã®maxmemoryè¨­å®š

è©³ç´°ã¯ `docs/CACHE_PERFORMANCE.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
